function getShortTimeString(a){return a.toString("HH:mm")}function getShortDateString(a){return a.toString("MMM d, yyyy")}function getJulianDate(a,b,c,d){return 367*a-Math.floor(7/4*(Math.floor((b+9)/12)+a))+Math.floor(275*b/9)+c-730531.5+d/24}function getSunPositionInDegrees(lg,la,theDate){with(Math){var uu=theDate.getUTCHours()+theDate.getUTCMinutes()/60,jj=getJulianDate(theDate.getFullYear(),theDate.getMonth()+1,theDate.getDate(),uu),T=jj/36525,k=PI/180,M=357.5291+35999.0503*T-1559e-7*T*T-4.5e-7*T*T*T;M%=360;var Lo=280.46645+36000.76983*T+3032e-7*T*T;Lo%=360;var DL=(1.9146-.004817*T-14e-6*T*T)*sin(k*M)+(.019993-101e-6*T)*sin(k*2*M)+29e-5*sin(k*3*M),L=Lo+DL,eps=23.43999-.013*T,delta=1/k*asin(sin(L*k)*sin(eps*k)),RA=1/k*atan2(cos(eps*k)*sin(L*k),cos(L*k));RA=(RA+360)%360;var GMST=280.46061837+360.98564736629*jj+387933e-9*T*T-T*T*T/3871e4;GMST=(GMST+360)%360;var LMST=GMST+lg,H=LMST-RA,eqt=(Lo-RA)*4,azm=1/k*atan2(-sin(H*k),cos(la*k)*tan(delta*k)-sin(la*k)*cos(H*k));azm=(azm+360)%360;var alt=1/k*asin(sin(la*k)*sin(delta*k)+cos(la*k)*cos(delta*k)*cos(H*k));return{altitude:alt,azimuth:azm}}}function getLightTimes(a,b,c){var d={},e=new Array,f=new Array,g=90,h=-90;for(key in global.firstSunAngles)e.push(global.firstSunAngles[key]),f.push(key);for(var i=0;i<24;i++)for(var j=0;j<60;j++){var k=new Date(c);k.setHours(i),k.setMinutes(j);var l=getSunPositionInDegrees(a,b,k).altitude;l>h&&(h=l),l<g&&(g=l),l>=e[0]&&(d[f[0]]=k,e.shift(),f.shift());if(e.length==0)break}var m=new Array,n=new Array;for(key in global.lastSunAngles)m.push(global.lastSunAngles[key]),n.push(key);for(var i=23;i>=0;i--)for(var j=59;j>=0;j--){var k=new Date(c);k.setHours(i),k.setMinutes(j);var l=getSunPositionInDegrees(a,b,k).altitude;l>h&&(h=l),l<g&&(g=l),l>=m[0]&&(d[n[0]]=k,m.shift(),n.shift());if(m.length==0)break}return d.highest=h,d.lowest=g,d}function getLightRanges(a){return ranges={Predawn:["predawn","morningStart","#C4B11B"],Morning:["morningStart","morningStop","#0F960F"],Evening:["eveningStart","eveningStop","#0F960F"],Twilight:["eveningStop","sunset","#C4B11B"]},a>=40?(ranges["Late Morning"]=["morningStop","highStart","#C4B11B"],ranges["Mid-day"]=["highStart","highStop","#999999"],ranges.Afternoon=["highStop","eveningStart","#C4B11B"]):a>=25?ranges["Mid-day"]=["morningStop","eveningStart","#C4B11B"]:ranges["All Day"]=["morningStart","eveningStop","#0F960F"],ranges}var global=this;global.firstSunAngles={predawn:-1,morningStart:5,morningStop:25,highStart:40},global.lastSunAngles={sunset:-1,eveningStop:5,eveningStart:25,highStop:40}